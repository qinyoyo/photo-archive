#### 将图像文件归档进行浏览

将图像文件按照拍摄时间进行分类，浏览。

归类图像在一个归类目录下，按照自定义规则组建子目录进行图像存储。

##### 依赖：

```
exiftool
ffmpeg
android mySteps App
```

参见 https://exiftool.org/

##### 文件去重

文件重复的判断规则

```
1）文件名和文件大小相同，认为相同
2）以下exiftool全部相同（但不能全部为空）
    拍摄时间或文件创建时间
    拍摄设备
    拍摄镜头
    IPTCDigest
    OriginalDocumentID
  如果以上exiftool全部为空则通过1）判断
3) 忽略以 .开头以及以 .web结束的子目录
```

##### 用法 ：

```
java -jar pv.jar <options>
```

options参数：

```
-a, --archive	: 执行归档维护
```

##### 归档维护功能

##### 1 批量重命名

```
重命名文件时，可以指定一个模板，模板可以包含以下元数据：
%y：拍摄时间年，4位
%M：拍摄时间月，2位
%d：拍摄时间日，2位
%h：拍摄时间小时，2位
%m：拍摄时间分钟，2位
%s：拍摄时间秒，2位

%o：拍摄设备
%l：拍摄位置
%u：主题代码，myStep App的足迹
%c：拍摄场景

%p：自动匹配目录名，忽略目录名前的数字和空格，如目录 201008 Canada匹配为 Canada
%f: 原文件名，排除数字和连接符号(-_)


使用默认值 ：
   可以使用 %x=defvalue%的形式指定一个缺省值 defvalue，当x取值为空时用缺省值代替。
   如 %y=2000%,表示使用年份，当没有拍摄时间时，使用2000
   默认值可以使用 {x} 的方式引用另外一个元数据
   如 %u={l}%,表示使用主题代码，当主题代码为空时，使用位置信息

%E：扩展名大写
%e：扩展名小写
    %E %e只能使用一个，任意位置

不指定模板则使用默认模板：%y%M%d-%h%m%s_%u={p}%%E
```

##### 2 根据图像文件获得gpx地理信息

将目录下的图像文件的gps信息收集到一个gpx文件中，用于对其他没有gps信息的图像文件进行同步

譬如：使用手机拍摄图像同步不支持gps的单反拍摄图像。

##### 3 校正图像拍摄时间

##### 4 根据gpx文件写入地理信息

将gpx文件(支持 mySteps App 生成的gpx文件)的gps信息写入到不包含gps信息的图像。

匹配条件：拍摄时间

##### 5 将属性写入到RAW文件

图像属性修改后，写回到RAW文件。

匹配条件：拍摄时间

##### 6 将一个目录合并入归档

将一个目录下的图像文件归档移动到第二个目录中。第二个目录的文件按照拍摄时间已经进行了归类。如果文件在第二个目录中找不到可以归档的子目录，则使用第一个目录的结构或按照月份自动建档归档(第一个目录没有子目录结构的情况)。

归档的文件在同级目录的Camera目录下。

##### 7 游记文件

游记文件为html文件，支持新建、编辑和格式化为标准格式。

支持 mySteps App 生成的游记文件

#### 图像及游记浏览

一个web应用，浏览目录结构下的图像，视频以及html游记。

pv.yml配置浏览目录和端口。

/ ：主目录浏览接口，可查询

图像支持：手势缩放，旋转，删除，幻灯播放

背景音乐

